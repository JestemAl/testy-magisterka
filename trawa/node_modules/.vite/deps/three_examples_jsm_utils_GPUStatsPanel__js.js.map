{
  "version": 3,
  "sources": ["../../three/examples/jsm/utils/GPUStatsPanel.js"],
  "sourcesContent": ["import Stats from '../libs/stats.module.js';\n\n// https://www.khronos.org/registry/webgl/extensions/EXT_disjoint_timer_query_webgl2/\nexport class GPUStatsPanel extends Stats.Panel {\n\n\tconstructor( context, name = 'GPU MS' ) {\n\n\t\tsuper( name, '#f90', '#210' );\n\n\t\tconst extension = context.getExtension( 'EXT_disjoint_timer_query_webgl2' );\n\n\t\tif ( extension === null ) {\n\n\t\t\tconsole.warn( 'GPUStatsPanel: disjoint_time_query extension not available.' );\n\n\t\t}\n\n\t\tthis.context = context;\n\t\tthis.extension = extension;\n\t\tthis.maxTime = 30;\n\t\tthis.activeQueries = 0;\n\n\t\tthis.startQuery = function () {\n\n\t\t\tconst gl = this.context;\n\t\t\tconst ext = this.extension;\n\n\t\t\tif ( ext === null ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// create the query object\n\t\t\tconst query = gl.createQuery();\n\t\t\tgl.beginQuery( ext.TIME_ELAPSED_EXT, query );\n\n\t\t\tthis.activeQueries ++;\n\n\t\t\tconst checkQuery = () => {\n\n\t\t\t\t// check if the query is available and valid\n\n\t\t\t\tconst available = gl.getQueryParameter( query, gl.QUERY_RESULT_AVAILABLE );\n\t\t\t\tconst disjoint = gl.getParameter( ext.GPU_DISJOINT_EXT );\n\t\t\t\tconst ns = gl.getQueryParameter( query, gl.QUERY_RESULT );\n\n\t\t\t\tconst ms = ns * 1e-6;\n\n\t\t\t\tif ( available ) {\n\n\t\t\t\t\t// update the display if it is valid\n\t\t\t\t\tif ( ! disjoint ) {\n\n\t\t\t\t\t\tthis.update( ms, this.maxTime );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tgl.deleteQuery( query );\n\n\t\t\t\t\tthis.activeQueries --;\n\n\n\t\t\t\t} else if ( gl.isContextLost() === false ) {\n\n\t\t\t\t\t// otherwise try again the next frame\n\t\t\t\t\trequestAnimationFrame( checkQuery );\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\trequestAnimationFrame( checkQuery );\n\n\t\t};\n\n\t\tthis.endQuery = function () {\n\n\t\t\t// finish the query measurement\n\t\t\tconst ext = this.extension;\n\t\t\tconst gl = this.context;\n\n\t\t\tif ( ext === null ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tgl.endQuery( ext.TIME_ELAPSED_EXT );\n\n\t\t};\n\n\t}\n\n}\n"],
  "mappings": ";;;;;AAGO,IAAM,gBAAN,cAA4B,qBAAM,MAAM;AAAA,EAE9C,YAAa,SAAS,OAAO,UAAW;AAEvC,UAAO,MAAM,QAAQ,MAAO;AAE5B,UAAM,YAAY,QAAQ,aAAc,iCAAkC;AAE1E,QAAK,cAAc,MAAO;AAEzB,cAAQ,KAAM,6DAA8D;AAAA,IAE7E;AAEA,SAAK,UAAU;AACf,SAAK,YAAY;AACjB,SAAK,UAAU;AACf,SAAK,gBAAgB;AAErB,SAAK,aAAa,WAAY;AAE7B,YAAM,KAAK,KAAK;AAChB,YAAM,MAAM,KAAK;AAEjB,UAAK,QAAQ,MAAO;AAEnB;AAAA,MAED;AAGA,YAAM,QAAQ,GAAG,YAAY;AAC7B,SAAG,WAAY,IAAI,kBAAkB,KAAM;AAE3C,WAAK;AAEL,YAAM,aAAa,MAAM;AAIxB,cAAM,YAAY,GAAG,kBAAmB,OAAO,GAAG,sBAAuB;AACzE,cAAM,WAAW,GAAG,aAAc,IAAI,gBAAiB;AACvD,cAAM,KAAK,GAAG,kBAAmB,OAAO,GAAG,YAAa;AAExD,cAAM,KAAK,KAAK;AAEhB,YAAK,WAAY;AAGhB,cAAK,CAAE,UAAW;AAEjB,iBAAK,OAAQ,IAAI,KAAK,OAAQ;AAAA,UAE/B;AAEA,aAAG,YAAa,KAAM;AAEtB,eAAK;AAAA,QAGN,WAAY,GAAG,cAAc,MAAM,OAAQ;AAG1C,gCAAuB,UAAW;AAAA,QAEnC;AAAA,MAED;AAEA,4BAAuB,UAAW;AAAA,IAEnC;AAEA,SAAK,WAAW,WAAY;AAG3B,YAAM,MAAM,KAAK;AACjB,YAAM,KAAK,KAAK;AAEhB,UAAK,QAAQ,MAAO;AAEnB;AAAA,MAED;AAEA,SAAG,SAAU,IAAI,gBAAiB;AAAA,IAEnC;AAAA,EAED;AAED;",
  "names": []
}
